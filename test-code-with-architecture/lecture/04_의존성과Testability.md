## 의존성

### 의존성이란 무엇인가?

* 컴퓨터 공학에서 말하는 의존성은 결합이랑 같은 개념이다.
* 다른 객체나 함수를 사용하는 상태를 의미한다.

> 인스턴스를 만드는 것보다 의존성 주입을 받는게 좋은 이유?
>
> New는 사실상 하드코딩이기 때문이다.

### 의존성 역전

* Dependency Injection은 의존성 주입
* Dependency Inversion는 의존성 역전
    * 첫째, 상위 모듈은 하위 모듈에 의존해서는 안된다. 상위 모듈과 하위 모듈 모두 추상화에 의존해야 한다.
    * 둘째, 추상화는 세부 사항에 의존해서는 안된다. 세부 사항이 추상화에 의존해야 한다.

"고수준 정책을 구현하는 코드는 저수준 세부사항을 구현하는 코드에 절대 의존해서는 안된다. 대신 세부사항이 정책에 의존해야 한다."

"자바와 같은 정적 타입 언어에서 이 말은 use, import, include 구문은 오직 인턴페이슨 ㅏ추상 클래스 같은 추상적인 선언만을 참조해야 한다는 뜻이다"

"우리가 의존하지 않도록 피하고자 하는 것은 바로 변동성이 큰 구체적인 요소다."

## 의존성과 테스트

* 갑지기 의존성은 왜?

  "테스트를 잘 하려면 의존성 주입과 의존선 역전을 잘 다룰 수 있어야 한다."

Ex) 마지막 로그인 시간

```java
class User {
    private long lastLoginTimestamp;
    public void login() {
        //...
        this.lastLoginTimestamp = Clock.systemUTC().millis();
    }
}
```

이코드는 의존성이 숨겨져 있다고 할 수 있다. 왜냐하면, 웹에서 사용한다고 했을 때, 로그인을 호출하게되면 클락을 사용 하는지 모르기 때문이다.

위의 코드르 테스트한다고 가정하면, 로그인한뒤에 마지막에 로그인한 시간을 비교해야하는데 여기에 어떤값이 들어가는지 모른다.

로그인 메소드를 호출한 시간이랑 결과를 비교하는 시점의 시간이 다를 수 밖에 없다.

### 의존성 주입 + 의존성 역전으로 해결

# Testablility

### 개념

얼마나 쉽게 input을 변경하고, output을 쉽게 검증할 수 있는가?